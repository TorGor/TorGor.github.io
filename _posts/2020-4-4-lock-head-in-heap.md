---
layout: post
title:  Java 锁的是对象，如何实现的？加锁过程是什么？
date:   2020-4-3 00:00:00 +0800
categories: document
tag: lock
---

>开篇思考
1. 对象在堆中的数据结构？和锁有什么关系？
2. 对象的锁是如何升级的？

还是绕不开底层。曾经一遍遍来自灵魂的追问，别再深入了，又不是那啥，有乐趣吗？  
嘿，还真的越深入越有趣。  
其实对象锁是由 Synchronized 来进行操控的，因为由虚拟机运行加锁步骤，而各种解释都是非常抽象，
所以很多人堆底层原理不是很理解。  
如果想理解手动加锁过程，可以看看这篇介绍《》[]()


# 对象在堆的内存结构

JVM 中的堆内存我们都知道是用来存储 Java 实例化对象的。到底存储了什么呢？用来存放动态产生的数据，比如 new 出来的对象。  
注意：创建出来的对象只包含属于各自的成员变量，并不包括成员方法。  
因为同一个类的对象拥有各自的成员变量，存储在各自的堆中，但是他们共享该类的方法，并不是创建新的对象就复制一份方法，方法都保存在方法区中。  
在堆中只会存储成员方法的地址，在调用的时候，根据地址去方法区中执行对应的成员方法。

堆中的数据结构：  


Java对象保存在内存中时，由以下三部分组成：
1. 对象头 : 
2. 实例数据
3. 对齐填充字节

对象头的内存结构：
![Mark Word](https://torgor.github.io/styles/images/jmm/heap-object-head-structure.png)





# 喜欢文章请关注我    
> 程序领域  
**点击关注+转发，私信发送【面试】或者【资料】可以收获更多资源**

![公众号](https://torgor.github.io/styles/images/my-public-ma.png)

![赞赏码](https://torgor.github.io/styles/images/my-zanshang-ma.png)








